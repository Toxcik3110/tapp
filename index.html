<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style1.css">
    <script src="index.js"></script>
    <title></title>
  </head>
  <body onload="getData('getTeams')">
      <header align="center">
          Приветствуем в TAPP!
      </header>
      <div class="list" id="second">
          <div class="content">
              <div class="AddTeam">
              <input type="text" id="u1" value="Связка:" readonly>
              <input id="team" type="text" value="">
              <input id="u2" type="button" onclick="addTeam" value="Добавить связку">
              </div>
              <div class="SelectTeam">
                  <select id="teams" required>
                      <option value="" disabled selected>Выберете команду</option>
                  </select>
              </div>
              <div class="SelectStage">
                  <select id="stages" required>
                      <option value="" disabled selected>Выберете этап</option>
                  </select>
              </div>
          </div>
      </div>
      <div class="bottom" align="center">
          <a href="timer.html" style="color:white;text-decoration:none">Судить</a>
      </div>
      <script type="text/javascript">
      function getData(str) {
          var xhttp;
          var boo = 0;
          xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
              if (xhttp.readyState = 4 && xhttp.status == 200 && boo < 2) {
                  boo = boo + 1;
                  console.log(JSON.parse(xhttp.responseText));
                  console.log(JSON.parse(xhttp.responseText).length);
                  var teams = JSON.parse(xhttp.responseText);
                  for(var i = 0; i < teams.length; i++) {
                      var option = document.createElement("option");
                      option.text = teams[i].name;
                      option.value= teams[i].id;
                      document.getElementById("teams").add(option);
                  }
                  getData1("getStages");
              }
          };
          xhttp.open("GET", "http://localhost:1337/" + str, true);
          xhttp.send();
      }
      function getData1(str) {
          var xhttp;
          var boo = 0;
          xhttp = new XMLHttpRequest();
          xhttp.onreadystatechange = function() {
              if (xhttp.readyState = 4 && xhttp.status == 200 && boo < 2) {
                  boo = boo + 1;
                  console.log(JSON.parse(xhttp.responseText));
                  console.log(JSON.parse(xhttp.responseText).length);
                  var stages = JSON.parse(xhttp.responseText);
                  for(var i = 0; i < stages.length; i++) {
                      var option = document.createElement("option");
                      option.text = stages[i].name;
                      option.value= stages[i].id;
                      document.getElementById("stages").add(option);
                  }
              }
          };
          xhttp.open("GET", "http://localhost:1337/" + str, true);
          xhttp.send();
      }
      </script>
  </body>
</html>
